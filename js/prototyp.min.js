function showMap(e,t){map=L.map("map").setView([e,t],13);marker=L.marker([e,t],{icon:myShip,title:"My ship",draggable:false,opacity:.9}).addTo(map);marker.bindPopup("φ: "+dd2dm(e,"lat",5)+"<br/>λ: "+dd2dm(t,"lng",5)).openPopup();openSeaMap=(new L.TileLayer("https://a.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:18})).addTo(map);var n=(new L.TileLayer("https://tiles.openseamap.org/seamark/{z}/{x}/{y}.png",{maxZoom:18})).addTo(map);var r=(new L.TileLayer("https://tiles.openseamap.org/sport/{z}/{x}/{y}.png",{maxZoom:18})).addTo(map);var i=new L.Control.SimpleMarkers;map.addControl(i);if(!$("#Genauigkeit").val()=="on"){GPS_Genauigkeit="<tr><td align='left'>Genauigkeit der Positionsdaten: </td><td align='right'>"+parseInt(accuracy)+"</td><td align='left'>m</td></tr>"}else{GPS_Genauigkeit=""}$("#Navi_Schiffsposition","#Navi_Winddaten").empty();$("#Navi_Schiffsposition").append("Schiffsposition: φ: "+dd2dm(e,"lat",5)+"; λ: "+dd2dm(t,"lng",5));var s=!$("#Navi_Wegpunkt").text()?"<hr size='1px' align='center' width='70%' color='#c0c0c0' noshade><b>ACHTUNG:</b> Bisher kein Wegpunkt definiert!":$("#Navi_Wegpunkt").text();$("#Navi_Wegpunkt").append(s);$("#Navi_Winddaten").empty();var o="<table width='100%' cellpadding='1' cellspacing='0' border='0'"+GPS_Genauigkeit+"<tr><td align='left'>Windrichtung: </td><td align='right'>"+$("#windRichtung").val()+"</td><td align='left'>°</td></tr>"+"<tr><td align='left'>Oszillierender Wind: </td><td align='right'>"+$("#distLayline").val()+"</td><td align='left'>%</td></tr>"+"</table>";$("#Navi_Winddaten").append(o)}function showPosition(e){myLat=e.coords.latitude;myLng=e.coords.longitude;accuracy=e.coords.accuracy;altitude=e.coords.altitude;altitudeAccuracy=e.coords.altitudeAccuracy;heading=e.coords.heading;speed=e.coords.speed;urlpara=decodeURIComponent(window.location.search);if(urlpara){var t=urlpara.slice(1);var n=t.split("&");myLat=parseFloat(n[0].split("="));myLng=parseFloat(n[1].split("="))}showMap(myLat,myLng)}function handleError(e){switch(error.code){case error.PERMISSION_DENIED:alert("Der Nutzer möchte keinen Zugriff auf GPS-Daten teilen.");break;case error.POSITION_UNAVAILABLE:alert("Die Geodaten sind nicht erreichbar.");break;case error.PERMISSION_DENIED:alert("Timeout erhalten");break;default:alert("Unbekannter Error");break}}function getLocation(){if(navigator.geolocation){var e={timeout:6e4,enableHighAccuracy:true};navigator.geolocation.getCurrentPosition(showPosition,handleError,e)}else{alert("Sorry, geolocation not supported in this browser")}}function watchLocation(){if(navigator.geolocation){var e={timeout:6e4,enableHighAccuracy:true};watchID=navigator.geolocation.watchPosition(showPosition,handleError,e)}else{alert("Sorry, geolocation not supported in this browser")}}function clearWatch(){if(watchID){navigator.geolocation.clearWatch(watchID);watchID=null}}function KursWinkel_KursLaenge(WayPoint_analog,ShipPoint_analog,AlphaA,KW,KP,c,Windstaerke,Sicherheit){var KursWL_ARR=[];var aussenFlag=false;var BetaL,BetaL_Sec;eval("BetaL = parseFloat(ship_"+Windstaerke+"_beat_angel);");BetaL_Sec=parseFloat(BetaL-parseInt(2*BetaL*Sicherheit/100));AlphaW=KW<180?KW:KW-360;AlphaZ=KP<180?KP:KP-360;AlphaKP=Math.abs(AlphaW-AlphaZ)<BetaL?Math.abs(AlphaW-AlphaZ):Math.abs(360-Math.abs(AlphaW-AlphaZ));AlphaB=Math.abs(AlphaW-AlphaZ)<BetaL?Math.abs(AlphaA+(AlphaW-AlphaZ)):Math.abs(360-Math.abs(AlphaA+(AlphaW-AlphaZ)));AlphaC=Math.abs(AlphaW-AlphaZ)<BetaL?Math.abs(AlphaA-(AlphaW-AlphaZ)):Math.abs(360-Math.abs(AlphaA-(AlphaW-AlphaZ)));BetaP=BetaL+AlphaKP;BetaP_Sec=BetaL_Sec+AlphaKP;if(AlphaC>AlphaB){Gamma=180-AlphaB-BetaP_Sec}else{Gamma=180-AlphaC-BetaP_Sec}if(AlphaA<AlphaKP){KursWinkel=KP;KursLinienlaenge=c;aussenFlag=true}else{if(KP<180){if(AlphaC>AlphaB){KursWinkel=AlphaZ+AlphaB}else{KursWinkel=AlphaZ-AlphaC}}else{if(AlphaC>AlphaB){KursWinkel=360+AlphaZ+AlphaB}else{KursWinkel=360+AlphaZ-AlphaC}}KursLinienlaenge=c*MathD.sin(AlphaKP+BetaL_Sec)/MathD.sin(Gamma)}KursWL_ARR[0]=KursWinkel;KursWL_ARR[1]=KursLinienlaenge;KursWL_ARR[2]=BetaL;KursWL_ARR[3]=BetaL_Sec;KursWL_ARR[4]=aussenFlag;return KursWL_ARR}function initDB(){if(localStorage.getItem("db_VPP_messwerte")){VPP_messwerteDB=new localStorageDB("VPP_messwerte",localStorage)}else{VPP_messwerteDB=new localStorageDB("VPP_messwerte",localStorage);if(VPP_messwerteDB.isNew()){VPP_messwerteDB.createTable("ship",["code","datum","name","shipTyp","shipNum","shipLOA","shipLWL","shipBOA","shipBWL","shipT","shipD","shipB","shipV","shipAS","shipGPH","ship_6_Array","ship_8_Array","ship_10_Array","ship_12_Array","ship_14_Array","ship_16_Array","ship_18_Array","ship_20_Array"]);VPP_messwerteDB.insert("ship",{code:"V1.0",datum:$.getActualiCal("UTC"),name:"Cantaloop IV",shipTyp:"Hanse 430 (2007)",shipNum:"GER 5950",shipLOA:"13.15",shipLWL:"12.00",shipBOA:"4.250",shipBWL:"3.950",shipT:"2.186",shipD:"10763",shipB:"3200",shipV:"8500",shipAS:"123.50",shipGPH:"586.5",ship_6_Array:[45,3.46,5.41,5.81,6.19,6.19,6.2,6.01,5.4,4.55,142,3.94,53,null],ship_8_Array:[43,4.18,6.44,6.89,7.3,7.45,7.49,7.3,6.63,5.7,148,4.94,52,null],ship_10_Array:[43,4.74,7.28,7.66,7.93,8.02,8.15,8.03,7.61,6.73,151,5.83,52,null],ship_12_Array:[42,5.12,7.72,8.03,8.28,8.28,8.56,8.47,8.15,7.58,154,6.63,51,null],ship_14_Array:[42,5.3,7.89,8.18,8.52,8.57,8.81,8.91,8.55,8.12,166,7.29,51,null],ship_16_Array:[41,5.4,7.97,8.25,8.67,8.87,9.03,9.33,8.99,8.5,180,7.89,50,null],ship_18_Array:[41,5.46,8.04,8.3,8.74,9.09,9.22,9.57,9.49,8.92,180,8.28,50,null],ship_20_Array:[42,5.52,8.1,8.35,8.8,9.32,9.41,9.8,9.99,9.34,180,8.67,51,null]});VPP_messwerteDB.commit()}}readVPP();updateVPP()}function openDB(){VPP_messwerteDB=new localStorageDB("VPP_messwerte",localStorage)}function readVPP(){recDB=VPP_messwerteDB.query("ship");for(var i=0 in recDB){if(recDB[i].code=="V1.0"){$("#shipName").val(recDB[i].name);$("#shipTyp").val(recDB[i].shipTyp);$("#shipNum").val(recDB[i].shipNum);$("#shipLOA").val(recDB[i].shipLOA);$("#shipLWL").val(recDB[i].shipLWL);$("#shipBOA").val(recDB[i].shipBOA);$("#shipBWL").val(recDB[i].shipBWL);$("#shipT").val(recDB[i].shipT);$("#shipD").val(recDB[i].shipD);$("#shipB").val(recDB[i].shipB);$("#shipV").val(recDB[i].shipV);$("#shipAS").val(recDB[i].shipAS);$("#shipGPH").val(recDB[i].shipGPH);var kn=4;for(j=6;j<=20;j+=2){kn+=2;if(j!==18){eval("ship_"+kn+"_beat_angel = recDB[i].ship_"+kn+"_Array[0];");eval("ship_"+kn+"_beat = recDB[i].ship_"+kn+"_Array[1];");eval("ship_"+kn+"_52 = recDB[i].ship_"+kn+"_Array[2];");eval("ship_"+kn+"_60 = recDB[i].ship_"+kn+"_Array[3];");eval("ship_"+kn+"_75 = recDB[i].ship_"+kn+"_Array[4];");eval("ship_"+kn+"_90 = recDB[i].ship_"+kn+"_Array[5];");eval("ship_"+kn+"_110 = recDB[i].ship_"+kn+"_Array[6];");eval("ship_"+kn+"_120 = recDB[i].ship_"+kn+"_Array[7];");eval("ship_"+kn+"_135 = recDB[i].ship_"+kn+"_Array[8];");eval("ship_"+kn+"_150 = recDB[i].ship_"+kn+"_Array[9];");eval("ship_"+kn+"_run_angel = recDB[i].ship_"+kn+"_Array[10];");eval("ship_"+kn+"_run = recDB[i].ship_"+kn+"_Array[11];")}}}}var kn=4;for(j=6;j<=20;j+=2){kn+=2;if(j!==18){eval('$("#ship_'+kn+'_beat_angel").val(ship_'+kn+"_beat_angel);");eval('$("#ship_'+kn+'_beat").val(ship_'+kn+"_beat);");eval('$("#ship_'+kn+'_52").val(ship_'+kn+"_52);");eval('$("#ship_'+kn+'_60").val(ship_'+kn+"_60);");eval('$("#ship_'+kn+'_75").val(ship_'+kn+"_75);");eval('$("#ship_'+kn+'_90").val(ship_'+kn+"_90);");eval('$("#ship_'+kn+'_110").val(ship_'+kn+"_110);");eval('$("#ship_'+kn+'_120").val(ship_'+kn+"_120);");eval('$("#ship_'+kn+'_135").val(ship_'+kn+"_135);");eval('$("#ship_'+kn+'_150").val(ship_'+kn+"_150);");eval('$("#ship_'+kn+'_run_angel").val(ship_'+kn+"_run_angel);");eval('$("#ship_'+kn+'_run").val(ship_'+kn+"_run);")}}$("#ship_18_beat_angel").val(parseInt((parseInt($("#ship_16_beat_angel").val())+parseInt($("#ship_20_beat_angel").val()))/2));$("#ship_18_beat").val(round((parseFloat($("#ship_16_beat").val())+parseFloat($("#ship_20_beat").val()))/2,2));$("#ship_18_52").val(round((parseFloat($("#ship_16_52").val())+parseFloat($("#ship_20_52").val()))/2,2));$("#ship_18_60").val(round((parseFloat($("#ship_16_60").val())+parseFloat($("#ship_20_60").val()))/2,2));$("#ship_18_75").val(round((parseFloat($("#ship_16_75").val())+parseFloat($("#ship_20_75").val()))/2,2));$("#ship_18_90").val(round((parseFloat($("#ship_16_90").val())+parseFloat($("#ship_20_90").val()))/2,2));$("#ship_18_110").val(round((parseFloat($("#ship_16_110").val())+parseFloat($("#ship_20_110").val()))/2,2));$("#ship_18_120").val(round((parseFloat($("#ship_16_120").val())+parseFloat($("#ship_20_120").val()))/2,2));$("#ship_18_135").val(round((parseFloat($("#ship_16_135").val())+parseFloat($("#ship_20_135").val()))/2,2));$("#ship_18_150").val(round((parseFloat($("#ship_16_150").val())+parseFloat($("#ship_20_150").val()))/2,2));$("#ship_18_run_angel").val(Math.round((Math.round($("#ship_16_run_angel").val())+Math.round($("#ship_20_run_angel").val()))/2));$("#ship_18_run").val(round((parseFloat($("#ship_16_run").val())+parseFloat($("#ship_20_run").val()))/2,2))}function updateVPP(){recDB=VPP_messwerteDB.query("ship");best_beat_ARR=[];var e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v=null;var m=[];$("#table-output").empty();$("#equation-output").empty();$("#perform-output").empty();m=$("#ship_6_beat_angel").val()+" "+$("#ship_6_beat").val()+",52 "+$("#ship_6_52").val()+",60 "+$("#ship_6_60").val()+",75 "+$("#ship_6_75").val()+",90 "+$("#ship_6_90").val()+",110 "+$("#ship_6_110").val()+",120 "+$("#ship_6_120").val()+",135 "+$("#ship_6_135").val()+",150 "+$("#ship_6_150").val()+","+$("#ship_6_run_angel").val()+" "+$("#ship_6_run").val();best_beat_ARR.push(Interpoliere_VPP(6,m.split(",")));m=$("#ship_8_beat_angel").val()+" "+$("#ship_8_beat").val()+",52 "+$("#ship_8_52").val()+",60 "+$("#ship_8_60").val()+",75 "+$("#ship_8_75").val()+",90 "+$("#ship_8_90").val()+",110 "+$("#ship_8_110").val()+",120 "+$("#ship_8_120").val()+",135 "+$("#ship_8_135").val()+",150 "+$("#ship_8_150").val()+","+$("#ship_8_run_angel").val()+" "+$("#ship_8_run").val();best_beat_ARR.push(Interpoliere_VPP(8,m.split(",")));m=$("#ship_10_beat_angel").val()+" "+$("#ship_10_beat").val()+",52 "+$("#ship_10_52").val()+",60 "+$("#ship_10_60").val()+",75 "+$("#ship_10_75").val()+",90 "+$("#ship_10_90").val()+",110 "+$("#ship_10_110").val()+",120 "+$("#ship_10_120").val()+",135 "+$("#ship_10_135").val()+",150 "+$("#ship_10_150").val()+","+$("#ship_10_run_angel").val()+" "+$("#ship_10_run").val();best_beat_ARR.push(Interpoliere_VPP(10,m.split(",")));m=$("#ship_12_beat_angel").val()+" "+$("#ship_12_beat").val()+",52 "+$("#ship_12_52").val()+",60 "+$("#ship_12_60").val()+",75 "+$("#ship_12_75").val()+",90 "+$("#ship_12_90").val()+",110 "+$("#ship_12_110").val()+",120 "+$("#ship_12_120").val()+",135 "+$("#ship_12_135").val()+",150 "+$("#ship_12_150").val()+","+$("#ship_10_run_angel").val()+" "+$("#ship_10_run").val();best_beat_ARR.push(Interpoliere_VPP(12,m.split(",")));m=$("#ship_14_beat_angel").val()+" "+$("#ship_14_beat").val()+",52 "+$("#ship_14_52").val()+",60 "+$("#ship_14_60").val()+",75 "+$("#ship_14_75").val()+",90 "+$("#ship_14_90").val()+",110 "+$("#ship_14_110").val()+",120 "+$("#ship_14_120").val()+",135 "+$("#ship_14_135").val()+",150 "+$("#ship_14_150").val()+","+$("#ship_14_run_angel").val()+" "+$("#ship_14_run").val();best_beat_ARR.push(Interpoliere_VPP(14,m.split(",")));m=$("#ship_16_beat_angel").val()+" "+$("#ship_16_beat").val()+",52 "+$("#ship_16_52").val()+",60 "+$("#ship_16_60").val()+",75 "+$("#ship_16_75").val()+",90 "+$("#ship_16_90").val()+",110 "+$("#ship_16_110").val()+",120 "+$("#ship_16_120").val()+",135 "+$("#ship_16_135").val()+",150 "+$("#ship_16_150").val()+","+$("#ship_16_run_angel").val()+" "+$("#ship_16_run").val();best_beat_ARR.push(Interpoliere_VPP(16,m.split(",")));m=$("#ship_18_beat_angel").val()+" "+$("#ship_18_beat").val()+",52 "+$("#ship_18_52").val()+",60 "+$("#ship_18_60").val()+",75 "+$("#ship_18_75").val()+",90 "+$("#ship_18_90").val()+",110 "+$("#ship_18_110").val()+",120 "+$("#ship_18_120").val()+",135 "+$("#ship_18_135").val()+",150 "+$("#ship_18_150").val()+","+$("#ship_18_run_angel").val()+" "+$("#ship_18_run").val();best_beat_ARR.push(Interpoliere_VPP(18,m.split(",")));m=$("#ship_20_beat_angel").val()+" "+$("#ship_20_beat").val()+",52 "+$("#ship_20_52").val()+",60 "+$("#ship_20_60").val()+",75 "+$("#ship_20_75").val()+",90 "+$("#ship_20_90").val()+",110 "+$("#ship_20_110").val()+",120 "+$("#ship_20_120").val()+",135 "+$("#ship_20_135").val()+",150 "+$("#ship_20_150").val()+","+$("#ship_20_run_angel").val()+" "+$("#ship_20_run").val();best_beat_ARR.push(Interpoliere_VPP(20,m.split(",")));var g="<b>Schnellste Am-Wind-Kurse mit höchster Höhe:</b><br/>"+'<table cellpadding="3" cellspacing="0" border="0" frame="void" rules="cols">'+'<tr bgcolor="#c0c0c0"><th align="right">Wind [kn]</th><th align="right">Winkel [°]</th><th align="right">Geschwindigkeit [kn]</th><th align="right">Höhe [sm]</th>';for(var y in best_beat_ARR){g+="<tr>"+'<td align="right">'+best_beat_ARR[y]["wind"]+'</td><td align="right">'+best_beat_ARR[y]["winkel"]+'</td><td align="right">'+best_beat_ARR[y]["v"]+'</td><td align="right">'+best_beat_ARR[y]["h"]+"</tr>"}g+="</table>";$("#perform-output").append(g);for(var y=0 in recDB){if(recDB[y].code=="V1.0"){VPP_messwerteDB.insertOrUpdate("ship",{code:"V1.0"},{code:"V1.0",datum:$.getActualiCal("UTC"),name:$("#shipName").val(),shipTyp:$("#shipTyp").val(),shipNum:$("#shipNum").val(),shipLOA:$("#shipLOA").val(),shipLWL:$("#shipLWL").val(),shipBOA:$("#shipBOA").val(),shipBWL:$("#shipBWL").val(),shipT:$("#shipT").val(),shipD:$("#shipD").val(),shipB:$("#shipB").val(),shipV:$("#shipV").val(),shipAS:$("#shipAS").val(),shipGPH:$("#shipGPH").val(),ship_6_Array:[$("#ship_6_beat_angel").val(),$("#ship_6_beat").val(),$("#ship_6_52").val(),$("#ship_6_60").val(),$("#ship_6_75").val(),$("#ship_6_90").val(),$("#ship_6_110").val(),$("#ship_6_120").val(),$("#ship_6_135").val(),$("#ship_6_150").val(),$("#ship_6_run_angel").val(),$("#ship_6_run").val(),best_beat_ARR[0]["winkel"].toString(),"null"],ship_8_Array:[$("#ship_8_beat_angel").val(),$("#ship_8_beat").val(),$("#ship_8_52").val(),$("#ship_8_60").val(),$("#ship_8_75").val(),$("#ship_8_90").val(),$("#ship_8_110").val(),$("#ship_8_120").val(),$("#ship_8_135").val(),$("#ship_8_150").val(),$("#ship_8_run_angel").val(),$("#ship_8_run").val(),best_beat_ARR[1]["winkel"].toString(),"null"],ship_10_Array:[$("#ship_10_beat_angel").val(),$("#ship_10_beat").val(),$("#ship_10_52").val(),$("#ship_10_60").val(),$("#ship_10_75").val(),$("#ship_10_90").val(),$("#ship_10_110").val(),$("#ship_10_120").val(),$("#ship_10_135").val(),$("#ship_10_150").val(),$("#ship_10_run_angel").val(),$("#ship_10_run").val(),best_beat_ARR[2]["winkel"].toString(),"null"],ship_12_Array:[$("#ship_12_beat_angel").val(),$("#ship_12_beat").val(),$("#ship_12_52").val(),$("#ship_12_60").val(),$("#ship_12_75").val(),$("#ship_12_90").val(),$("#ship_12_110").val(),$("#ship_12_120").val(),$("#ship_12_135").val(),$("#ship_12_150").val(),$("#ship_12_run_angel").val(),$("#ship_12_run").val(),best_beat_ARR[3]["winkel"].toString(),"null"],ship_14_Array:[$("#ship_14_beat_angel").val(),$("#ship_14_beat").val(),$("#ship_14_52").val(),$("#ship_14_60").val(),$("#ship_14_75").val(),$("#ship_14_90").val(),$("#ship_14_110").val(),$("#ship_14_120").val(),$("#ship_14_135").val(),$("#ship_14_150").val(),$("#ship_14_run_angel").val(),$("#ship_14_run").val(),best_beat_ARR[4]["winkel"].toString(),"null"],ship_16_Array:[$("#ship_16_beat_angel").val(),$("#ship_16_beat").val(),$("#ship_16_52").val(),$("#ship_16_60").val(),$("#ship_16_75").val(),$("#ship_16_90").val(),$("#ship_16_110").val(),$("#ship_16_120").val(),$("#ship_16_135").val(),$("#ship_16_150").val(),$("#ship_16_run_angel").val(),$("#ship_16_run").val(),best_beat_ARR[5]["winkel"].toString(),"null"],ship_18_Array:[ship_18_beat_angel,ship_18_beat,ship_18_52,ship_18_60,ship_18_75,ship_18_90,ship_18_110,ship_18_120,ship_18_135,ship_18_150,ship_18_run_angel,ship_18_run,best_beat_ARR[6]["winkel"].toString(),"null"],ship_20_Array:[$("#ship_20_beat_angel").val(),$("#ship_20_beat").val(),$("#ship_20_52").val(),$("#ship_20_60").val(),$("#ship_20_75").val(),$("#ship_20_90").val(),$("#ship_20_110").val(),$("#ship_20_120").val(),$("#ship_20_135").val(),$("#ship_20_150").val(),$("#ship_20_run_angel").val(),$("#ship_20_run").val(),best_beat_ARR[7]["winkel"].toString(),"null"]});VPP_messwerteDB.commit()}}}function Interpoliere_VPP(e,t){var n,r,i,s,o;var u={ParseError:"Die Eingabe konnte nicht eingelesen werden.",NotEnoughPoints:"Anzal der Stützpunkte nicht ausreichend.",InvalidChars:"Die Eingabe der Stützpunkte beinhaltet falsche Zeichen.",SameXDifferentY:"Zwei Stützpunkte haben den gleichen x-Wert, allerdings unterschiedliche y-Werte."};var a=t;var f=true;n=[];for(var l=0;l<a.length;l++){var c=a[l].split(/\s+/g);if(c.length!==2){f=false;break}else{if(!/^\d+$/.test(c[0])||/^\d+$/.test(c[1])){showError("InvalidChars");return}var h=parseFloat(c[0].replace(String.fromCharCode(8722),"-")),p=parseFloat(c[1].replace(String.fromCharCode(8722),"-"));if(isNaN(h)||isNaN(p)){f=false;break}n.push({x:h,y:p})}}if(!f){showError("ParseError");return}try{n=processPoints(n)}catch(d){showError(d.message);return}var v=getMinMax(n);r=v.minX;i=v.maxX;s=v.minY;o=v.maxY;functions=cubicSplineInterpolation(n);lastX=undefined;showEquations(e);showTable(e);return calculateBestBrng(e)}function calculateBestBrng(e){var t=[];f=function(e){for(var t=0;t<functions.length;t++){if(functions[t].range.xmin<=e&&functions[t].range.xmax>=e){return functions[t].a*e*e*e+functions[t].b*e*e+functions[t].c*e+functions[t].d}}return undefined};for(var n=1;n<=180;n++){beat_angel[n]=typeof f(n)==="undefined"?"0":round(f(n),4);MaxHoehe[n]=round(beat_angel[n]*MathD.cos(n),4)}for(var n=30;n<=90;n++){t[n]=[];t[n]={wind:e,winkel:n,v:beat_angel[n],h:MaxHoehe[n]}}t.sort(function(e,t){var e=e.h,t=t.h;return e==t?0:e>t?-1:1});return t[0]}function showPoints(){var e="";for(var t=0;t<points.length;t++){if(t!==0)e+="; ";e+="P"+t+"=("+points[t].x+"|"+points[t].y+")"}document.getElementById("point-output").innerHTML=e}function showEquations(e){var t="<b>Kubische Gleichungen zwischen Stützstellen für Windstärke "+e+"kn:</b><br/>";for(var n=0;n<functions.length;n++){var r=functions[n];t+="s"+n+"(x) = "+roundEng(r.a)+" * x^3 + "+roundEng(r.b)+" * x^2 + "+roundEng(r.c)+" * x + "+roundEng(r.d)+", if x Element in ["+r.range.xmin+","+r.range.xmax+"]"+(n!==functions.length-1?", </br>":"</br>")}$("#equation-output").append(t)}function showTable(e){f=function(e){for(var t=0;t<functions.length;t++){if(functions[t].range.xmin<=e&&functions[t].range.xmax>=e){return functions[t].a*e*e*e+functions[t].b*e*e+functions[t].c*e+functions[t].d}}return undefined};for(var t=1;t<=180;t++){beat_angel[t]=typeof f(t)==="undefined"?"0":round(f(t),4);MaxHoehe[t]=round(beat_angel[t]*MathD.cos(t),4)}var n="<b>Interpolierte Am-Wind-Kurse für Windstärke "+e+"kn:</b><br/>"+'<table cellpadding="3" cellspacing="1" border="1" frame="void" rules="cols" style="border: 1px solid gray;">'+'<tr bgcolor="#c0c0c0"><th align="right">α [°]</th><th style="border: 1px solid gray;">v [kn]</th><th style="border: 1px solid gray;">h [sm]</th><th>α [°]</th><th style="border: 1px solid gray;">v [kn]</th><th style="border: 1px solid gray;">h [sm]</th><th>α [°]</th><th style="border: 1px solid gray;">v [kn]</th><th style="border: 1px solid gray;">h [sm]</th><th>α [°]</th><th style="border: 1px solid gray;">v [kn]</th><th style="border: 1px solid gray;">h [sm]</th><th>α [°]</th><th style="border: 1px solid gray;">v [kn]</th><th style="border: 1px solid gray;">h [sm]</th></tr>';for(var t=1;t<=10;t++){n+="<tr>"+'<td align="right" bgcolor="#00FFFF">'+(40- -t)+"</td><td>"+beat_angel[40+t]+"</td><td>"+MaxHoehe[40+t]+"</td>"+'<td align="right" bgcolor="#00FFFF">'+(50- -t)+"</td><td>"+beat_angel[50+t]+"</td><td>"+MaxHoehe[50+t]+"</td>"+'<td align="right" bgcolor="#00FFFF">'+(60- -t)+"</td><td>"+beat_angel[60+t]+"</td><td>"+MaxHoehe[60+t]+"</td>"+'<td align="right" bgcolor="#00FFFF">'+(70- -t)+"</td><td>"+beat_angel[70+t]+"</td><td>"+MaxHoehe[70+t]+"</td>"+'<td align="right" bgcolor="#00FFFF">'+(80- -t)+"</td><td>"+beat_angel[80+t]+"</td><td>"+MaxHoehe[80+t]+"</td>"+"</tr>"}n+="</table>";$("#table-output").append(n)}function showError(e){alert(e)}function hideError(){alert()}function processPoints(e){e.sort(function(e,t){if(e.x<t.x)return-1;if(e.x===t.x)return 0;return 1});for(var t=0;t<e.length;t++){if(t<e.length-1&&e[t].x===e[t+1].x){if(e[t].y===e[t+1].y){e.splice(t,1);t--}else{throw Error("SameXDifferentY")}}}if(e.length<2){throw Error("NotEnoughPoints")}return e}function getMinMax(e){minX=e[0].x;maxX=e[0].x;minY=e[0].y;maxY=e[0].y;for(var t=1;t<e.length;t++){minX=Math.min(minX,e[t].x);maxX=Math.max(maxX,e[t].x);minY=Math.min(minY,e[t].y);maxY=Math.max(maxY,e[t].y)}return{minX:minX,maxX:maxX,minY:minY,maxY:maxY}}function cubicSplineInterpolation(e){var t=0;var n=(e.length-1)*4;var r=[];for(var i=0;i<(e.length-1)*4;i++){r.push([]);for(var s=0;s<=(e.length-1)*4;s++){r[i].push(0)}}for(var o=0;o<e.length-1;o++,t+=2){var u=e[o],a=e[o+1];r[t][o*4+0]=Math.pow(u.x,3);r[t][o*4+1]=Math.pow(u.x,2);r[t][o*4+2]=Math.pow(u.x,1);r[t][o*4+3]=1;r[t][n]=u.y;r[t+1][o*4+0]=Math.pow(a.x,3);r[t+1][o*4+1]=Math.pow(a.x,2);r[t+1][o*4+2]=Math.pow(a.x,1);r[t+1][o*4+3]=1;r[t+1][n]=a.y}for(var o=0;o<e.length-2;o++,t++){var a=e[o+1];r[t][o*4+0]=3*Math.pow(a.x,2);r[t][o*4+1]=2*a.x;r[t][o*4+2]=1;r[t][o*4+4]=-3*Math.pow(a.x,2);r[t][o*4+5]=-2*a.x;r[t][o*4+6]=-1}for(var o=0;o<e.length-2;o++,t++){var a=e[o+1];r[t][o*4+0]=6*a.x;r[t][o*4+1]=2;r[t][o*4+4]=-6*a.x;r[t][o*4+5]=-2}r[t][0+0]=6*e[0].x;r[t++][0+1]=2;r[t][n-4+0]=6*e[e.length-1].x;r[t][n-4+1]=2;var f=solveMatrix(r);var l=[];for(var i=0;i<f.length;i+=4){l.push({a:f[i],b:f[i+1],c:f[i+2],d:f[i+3],range:{xmin:e[i/4].x,xmax:e[i/4+1].x}})}return l}function solveMatrix(e){var t=e.length;for(var n=0;n<t;n++){for(var r=n+1;r<t;r++){if(e[n][n]==0){var i=n;while(e[i][n]==0)i++;var s=e[i].slice();e[i]=e[n].slice();e[n]=s.slice()}var o=-e[r][n]/e[n][n];for(var i=n;i<t+1;i++)e[r][i]+=o*e[n][i]}}var u=[];for(var n=t-1;n>=0;n--){u.unshift(e[n][t]/e[n][n]);for(var i=n-1;i>=0;i--){e[i][t]-=e[i][n]*u[0]}}return u}function round(e,t){t=!t?2:t;if(t<1||t>14)return false;var n=Math.pow(10,t);var r=(Math.round(e*n)/n).toString();if(r.indexOf(".")==-1)r+=".";r+=n.toString().substring(1);return r.substring(0,r.indexOf(".")+t+1)}function roundExp(e){return e.toExponential(4)}function roundEng(e){var t=roundExp(e).replace("e+0","").replace("e+","e");if(t.replace("e","").length!==t.length){t=t.replace("e"," * 10^")}return t}function dd2dm(e,t,n){var r=!n?1e3:Math.pow(10,parseInt(n));var i=Math.abs(parseInt(e));var s=round((Math.abs(e)-i)*60,5);var o=e<0?-1:1;var u=t=="lat"?o>0?"N":"S":o>0?"E":"W";if(!u)return i*o+"°"+s+"'";else return i+"°"+s+"'"+u}function dd2dms(e,t,n){var r=!n?1e3:Math.pow(10,parseInt(n));var i=Math.abs(parseInt(e));var s=(Math.abs(e)-i)*60;var o=s;s=Math.abs(parseInt(s));o=round((o-s)*60,5);var u=e<0?-1:1;var a=t=="lat"?u>0?"N":"S":u>0?"E":"W";if(!a)return i*u+"°"+s+"'"+o+'"';else return i+"°"+s+"'"+o+'"'+a}function dms2dd(e,t,n,r,i){var s=!i?1e3:Math.pow(10,parseInt(i));var o;if(r){o=r.toLowerCase()=="w"||r.toLowercase()=="s"?-1:1;r=r.toLowerCase()=="w"||r.toLowercase()=="s"||r.toLowercase()=="n"||r.toLowercase()=="e"?r.toUpperCase():""}else{o=e<0?-1:1;r=""}var u=round(Matg.abs(e)+(t*60+n)/3600,5);if(!r||r=="")return u*o+"°";else return u+"°"+r}function km2nm(e,t){return round(e/1.852,t)}function nm2km(e,t){return round(e*1.852,t)}function iOSversion(){}$(document).ready(function(){$(".windDir").knob({change:function(e){},release:function(e){console.log("release : "+e)},cancel:function(){console.log("cancel : ",this)},draw:function(){if(this.$.data("skin")=="tron"){this.cursorExt=.3;var e=this.arc(this.cv),t,n=1;this.g.lineWidth=this.lineWidth;if(this.o.displayPrevious){t=this.arc(this.v);this.g.beginPath();this.g.strokeStyle=this.pColor;this.g.arc(this.xy,this.xy,this.radius-this.lineWidth,t.s,t.e,t.d);this.g.stroke()}this.g.beginPath();this.g.strokeStyle=n?this.o.fgColor:this.fgColor;this.g.arc(this.xy,this.xy,this.radius-this.lineWidth,e.s,e.e,e.d);this.g.stroke();this.g.lineWidth=2;this.g.beginPath();this.g.strokeStyle=this.o.fgColor;this.g.arc(this.xy,this.xy,this.radius-this.lineWidth+1+this.lineWidth*2/3,0,2*Math.PI,false);this.g.stroke();return false}}});$("#watchSwitch").click(function(){$("#popupShowNavigation").popup("open")});$(".updateShip").click(function(){updateVPP();$("#popupSaveVPP").popup("open")});$("#changeWindpage").click(function(){if($("#Genauigkeit").val()=="on"){GPS_Genauigkeit="<tr><td align='left'>Genauigkeit der Positionsdaten: </td><td align='right'>"+parseInt(accuracy)+"</td><td align='left'>m</td></tr>"}else{GPS_Genauigkeit=""}$("#Navi_Winddaten").empty();var e="<table width='100%' cellpadding='1' cellspacing='0' border='0'"+GPS_Genauigkeit+"<tr><td align='left'>Windrichtung: </td><td align='right'>"+$("#windRichtung").val()+"</td><td align='left'>°</td></tr>"+"<tr><td align='left'>Oszillierender Wind: </td><td align='right'>"+$("#distLayline").val()+"</td><td align='left'>%</td></tr>"+"</table>";$("#Navi_Winddaten").append(e)});return false});var best_beat_angel=[];var best_run_angel=[];var beat_angel=[];var best_beat_ARR=[];var MaxHoehe=[];var functions=[];var f=function(e){return undefined};var toRadians=function(e){return e*(Math.PI/180)};var toDegree=function(e){return e*(180/Math.PI)};var roundNumber=function(e,t){t=t||10;return Math.round(e*Math.pow(10,t))/Math.pow(10,t)};var MathD={sin:function(e){return roundNumber(Math.sin(toRadians(e)))},cos:function(e){return roundNumber(Math.cos(toRadians(e)))},tan:function(e){return roundNumber(Math.tan(toRadians(e)))},asin:function(e){return roundNumber(toDegree(Math.asin(e)))},acos:function(e){return roundNumber(toDegree(Math.acos(e)))},atan:function(e){return roundNumber(toDegree(Math.atan(e)))}};(function(e){e.getActualiCal=function(e,t){var n=new Date;var r=/UTC/i.test(e)?n.getUTCFullYear():n.getFullYear();var i=n.getUTCMonth()+1;if(i<=9){i="0"+i}var s=/UTC/i.test(e)?n.getUTCDate():n.getDate();if(s<=9){s="0"+s}var o=/UTC/i.test(e)?n.getUTCHours():n.getHours();if(o<=9){o="0"+o}var u=/UTC/i.test(e)?n.getUTCMinutes():n.getMinutes();if(u<=9){u="0"+u}var a=/UTC/i.test(e)?n.getUTCSeconds():n.getSeconds();if(a<=9){a="0"+a}if(/UTC/i.test(e)){var f=/undefined/.test(t)?r+""+i+""+s+"T"+o+""+u+""+a+"Z":r+""+i+""+s}else{var f=/undefined/.test(t)?r+""+i+""+s+"T"+o+""+u+""+a:r+""+i+""+s}return f}})(jQuery);ver=iOSversion()
